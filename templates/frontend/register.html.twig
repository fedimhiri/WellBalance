{# templates/frontend/register.html.twig #}
{% extends 'frontend/base_frontend.html.twig' %}

{% block title %}Inscription - Clinique Médicale{% endblock %}

{% block body %}
<div class="auth-creative-wrapper py-5">
    <div class="auth-creative-inner">
        <div class="creative-card-wrapper">
            <div class="card my-4 overflow-hidden" style="z-index: 1">
                <div class="row flex-1 g-0">
                    <!-- Formulaire d'inscription -->
                    <div class="col-lg-6 h-100 my-auto">
                        <div class="creative-card-body card-body p-sm-5">
                            <h2 class="fs-20 fw-bolder mb-4">Créer un compte</h2>
                            <h4 class="fs-13 fw-bold mb-2">Rejoignez notre communauté médicale</h4>
                            <p class="fs-12 fw-medium text-muted">
                                Créez votre compte patient pour bénéficier de tous nos services en ligne.
                            </p>
                            
                            <form method="POST" action="{{ path('frontend_register') }}" class="w-100 mt-4 pt-2">
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <input type="text" 
                                               name="firstname" 
                                               class="form-control" 
                                               placeholder="Prénom" 
                                               required>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <input type="text" 
                                               name="lastname" 
                                               class="form-control" 
                                               placeholder="Nom" 
                                               required>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <input type="email" 
                                           name="email" 
                                           class="form-control" 
                                           placeholder="Adresse email" 
                                           required>
                                </div>
                                
                                <div class="mb-4">
                                    <input type="tel" 
                                           name="phone" 
                                           class="form-control" 
                                           placeholder="Téléphone" 
                                           required>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <div class="input-group">
                                            <input type="password" 
                                                   name="password" 
                                                   class="form-control" 
                                                   id="password"
                                                   placeholder="Mot de passe" 
                                                   required>
                                            <button class="btn btn-outline-secondary toggle-password" type="button">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-4">
                                        <input type="password" 
                                               name="confirm_password" 
                                               class="form-control" 
                                               placeholder="Confirmer le mot de passe" 
                                               required>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <div class="progress" style="height: 5px;">
                                        <div class="progress-bar" id="password-strength-bar" role="progressbar" style="width: 0%"></div>
                                    </div>
                                    <small class="text-muted" id="password-strength-text">Force du mot de passe</small>
                                </div>
                                
                                <div class="mt-4">
                                    <div class="form-check mb-2">
                                        <input type="checkbox" 
                                               class="form-check-input" 
                                               id="newsletter" 
                                               name="newsletter">
                                        <label class="form-check-label text-muted" for="newsletter">
                                            Je souhaite recevoir les actualités et offres de la clinique
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input type="checkbox" 
                                               class="form-check-input" 
                                               id="terms" 
                                               name="terms" 
                                               required>
                                    </div>
                                </div>
                                
                                <div class="mt-5">
                                    <button type="submit" class="btn btn-lg btn-primary w-100">
                                        Créer mon compte
                                    </button>
                                </div>
                            </form>
                            
                            <div class="mt-5 text-muted text-center">
                                <span>Vous avez déjà un compte ?</span>
                                <a href="{{ path('frontend_login') }}" class="fw-bold ms-1">
                                    Se connecter
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Image côté -->
                    <div class="col-lg-6 bg-primary">
                        <div class="h-100 d-flex align-items-center justify-content-center p-4">
                            <div class="text-center text-white">
                                <h3 class="fw-bold mb-3">Avantages de votre compte</h3>
                                <ul class="list-unstyled text-start mb-4">
                                    <li class="mb-2">
                                        <i class="bi bi-check-circle me-2"></i>
                                        Prise de rendez-vous en ligne
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-check-circle me-2"></i>
                                        Accès à votre dossier médical
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-check-circle me-2"></i>
                                        Consultations en vidéo
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-check-circle me-2"></i>
                                        Résultats d'analyses en ligne
                                    </li>
                                    <li class="mb-2">
                                        <i class="bi bi-check-circle me-2"></i>
                                        Rappels de rendez-vous
                                    </li>
                                </ul>
                                <div class="mt-4">
                                    <a href="{{ path('app_frontend_vue') }}" class="btn btn-light">
                                        <i class="bi bi-house me-2"></i>
                                        Retour à l'accueil
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Toggle password visibility
    const toggleBtns = document.querySelectorAll('.toggle-password');
    toggleBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const input = this.closest('.input-group').querySelector('input');
            const icon = this.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('bi-eye');
                icon.classList.add('bi-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('bi-eye-slash');
                icon.classList.add('bi-eye');
            }
        });
    });
    
    // Password strength checker
    const passwordInput = document.getElementById('password');
    const strengthBar = document.getElementById('password-strength-bar');
    const strengthText = document.getElementById('password-strength-text');
    
    if (passwordInput) {
        passwordInput.addEventListener('input', function() {
            const password = this.value;
            let strength = 0;
            
            // Check password strength
            if (password.length >= 8) strength += 25;
            if (/[A-Z]/.test(password)) strength += 25;
            if (/[0-9]/.test(password)) strength += 25;
            if (/[^A-Za-z0-9]/.test(password)) strength += 25;
            
            // Update progress bar
            strengthBar.style.width = strength + '%';
            
            // Update text and color
            if (strength < 25) {
                strengthBar.className = 'progress-bar bg-danger';
                strengthText.textContent = 'Très faible';
            } else if (strength < 50) {
                strengthBar.className = 'progress-bar bg-warning';
                strengthText.textContent = 'Faible';
            } else if (strength < 75) {
                strengthBar.className = 'progress-bar bg-info';
                strengthText.textContent = 'Moyen';
            } else {
                strengthBar.className = 'progress-bar bg-success';
                strengthText.textContent = 'Fort';
            }
        });
    }
    
    // Form validation
    const form = document.querySelector('form');
    if (form) {
        form.addEventListener('submit', function(e) {
            const password = document.querySelector('input[name="password"]').value;
            const confirmPassword = document.querySelector('input[name="confirm_password"]').value;
            const terms = document.getElementById('terms');
            
            if (password !== confirmPassword) {
                e.preventDefault();
                alert('Les mots de passe ne correspondent pas');
                return false;
            }
            
            if (!terms.checked) {
                e.preventDefault();
                alert('Vous devez accepter les conditions générales');
                return false;
            }
            
            // Show loading state
            const submitBtn = this.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span> Création en cours...';
                submitBtn.disabled = true;
            }
        });
    }
});
</script>
{% endblock %}